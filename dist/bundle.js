(()=>{"use strict";function e(){const e={},t=document.querySelector("form"),o=document.querySelector("div.form_buttons>button"),n=document.querySelector("div.form_calcResult>h2");let l=!1;for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o;for(let t of["creditSize","initialPayment","creditPeriod"])e[t].value>0&&(e[t].value=Math.floor(e[t].value));for(let o in e){const n=t.querySelector(`label[name=${o}]`);!e[o].value||e[o].value<=0?(l=!0,n.classList.add("isError")):n.classList.remove("isError")}if(l)n.innerHTML="- ₽",localStorage.setItem("monthlyPayment","-"),o.disabled=!0;else{const e=function(){const e={},t=document.querySelector("form");for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o.value;const o=e.creditSize,n=e.initialPayment,l=e.creditRate/12,r=12*e.creditPeriod,i=(1+l)**r*l/((1+l)**r-1)*(o-n);return isNaN(i)?"-":Math.floor(100*i)/100}();n.innerHTML=e+" ₽",localStorage.setItem("monthlyPayment",e),console.log("-"!==e,e),o.disabled="-"===e}}const t=localStorage.getItem("monthlyPayment"),o=window.location.pathname;t||"/index.html"===o||(window.location.href="index.html"),window.goToRequest=function(){window.location.href="./request.html"},window.goToCalculator=function(){window.location.href="./index.html"},window.handleForm=async function(){const e={},t=document.querySelector("form");let o=!1;for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o;for(let o of["name","familyName"]){const n=t.querySelector(`label[name=${o}]`);e[o].value.length<3?r(n):i(n)}const n=t.querySelector("label[name=phone]");/^(([0-9]){11})$/.test(e.phone.value)?i(n):r(n);const l=t.querySelector("label[name=e-mail]");if(/^[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}$/i.test(e["e-mail"].value)?i(l):r(l),!o){const e={};for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o.value;!async function(e){const t=fetch(" http://localhost/request",{method:"post",body:JSON.stringify(e)});console.log(""),console.log("Отправлено:",e);try{const e=await t;console.log(e.status),console.log(await e.json())}catch(e){console.log(e)}}(e)}function r(e){o=!0,e.classList.add("isError")}function i(e){e.classList.remove("isError")}},document.addEventListener("DOMContentLoaded",(()=>{!function(){const t=window.location.pathname,o=document.querySelector("form"),n=o.querySelectorAll("input");for(let e of n){const t=e.getAttribute("name");e.value=localStorage.getItem(t),e.addEventListener("input",(function(e){localStorage.setItem(t,e.target.value)}))}if("/index.html"===t){e();for(let t of n)t.addEventListener("input",e)}for(let e of n){const t=e.getAttribute("name"),n=o.querySelector(`label[name=${t}]`);e.value?n.classList.add("isActive"):n.classList.remove("isActive"),e.addEventListener("input",(function(t){e.value?n.classList.add("isActive"):n.classList.remove("isActive")}))}}()}))})();