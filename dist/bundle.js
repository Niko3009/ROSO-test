(()=>{"use strict";function e(){const e={},t=document.querySelector("form"),o=document.querySelector("div.form_buttons>button"),n=document.querySelector("div.form_calcResult>h2");let l=!1;for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o;for(let t of["creditSize","initialPayment","creditPeriod"])e[t].value>0&&(e[t].value=Math.floor(e[t].value));for(let o in e){const n=t.querySelector(`label[name=${o}]`);!e[o].value||e[o].value<=0?(l=!0,n.classList.add("isError")):n.classList.remove("isError")}const r=l?0:function(){const e={},t=document.querySelector("form");for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o.value;const o=e.creditSize,n=e.initialPayment,l=e.creditRate/100/12,r=12*e.creditPeriod;let i=(o-n)*(1+l)**r*l/((1+l)**r-1);return i=Math.floor(100*i)/100,i||0}();n.innerHTML=r+" ₽",localStorage.setItem("monthlyPayment",r),o.disabled=!(r>0)}function t(){const e={},t=document.querySelector("form"),o=document.querySelector("div.form_buttons>button");let n=!1;for(let o of t.querySelectorAll("input"))e[o.getAttribute("name")]=o;for(let o of["name","familyName"]){const n=t.querySelector(`label[name=${o}]`);e[o].value.length<3?i(n):a(n)}const l=t.querySelector("label[name=phone]");/^(([0-9]){11})$/.test(e.phone.value)?a(l):i(l);const r=t.querySelector("label[name=e-mail]");function i(e){n=!0,e.classList.add("isError")}function a(e){e.classList.remove("isError")}/^[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}$/i.test(e["e-mail"].value)?a(r):i(r),o.disabled=n}const o=localStorage.getItem("monthlyPayment"),n=window.location.pathname;window.goToRequest=()=>window.location.href="./request.html",window.goToCalculator=()=>window.location.href="./index.html",window.sendRequest=async function(){const e={},t=document.querySelector("form").querySelectorAll("input");for(let o of t)e[o.getAttribute("name")]=o.value;const o=fetch(" http://localhost/request",{method:"post",body:JSON.stringify(e)});try{alert("Форма отправлена (подробности в консоли)"),console.log("Отправлено:",e);const t=await o;console.log(await t.json())}catch(e){console.log(e)}},document.addEventListener("DOMContentLoaded",(()=>{!function(){const o=window.location.pathname,n=document.querySelector("form"),l=n.querySelectorAll("input");for(let e of l){const t=e.getAttribute("name");e.value=localStorage.getItem(t),e.addEventListener("input",(function(e){localStorage.setItem(t,e.target.value)}))}if("/index.html"===o||"/"===o){e();for(let t of l)t.addEventListener("input",e)}if("/request.html"===o){t();for(let e of l)e.addEventListener("input",t)}for(let e of l){const t=e.getAttribute("name"),o=n.querySelector(`label[name=${t}]`);e.value?o.classList.add("isActive"):o.classList.remove("isActive"),e.addEventListener("input",(function(t){e.value?o.classList.add("isActive"):o.classList.remove("isActive")}))}}(),"/request.html"!==n||o||(window.location.href="index.html")}))})();